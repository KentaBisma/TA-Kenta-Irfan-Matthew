timestamp	text
00-00	Slide 15 Relational Algebra Part 2 CSF2600700 - BASIS DATA SEMESTER GENAP 2019/2020
00-21	References
00-24	References Elmasri 7th edition: Chapter 8
00-32	References Elmasri 7th edition: Chapter 8 Stanford Database (CS145) Lecture 16
00-40	Pnumber, Dnum, Lname, Address, Bdate(((Plocation=‘Stafford’(PROJECT)) Dnum=Dnumber(DEPARTMENT)) Mgr_ssn=Ssn(EMPLOYEE)) Query Tree Example: For every project located in 'Stafford', list the project number, the controlling department number, and the department manager's last name, address, and birth date.
04-10	Query Tree
04-30	Additional RA Operations Aggregate & Grouping Recursive Closure Relation Outer Join Outer Union
04-44	Aggregate & Grouping Notation: <grouping attributes> <function list>(R) Example: Retrieve each department number, the number of employees in the department, and their average salary. R(Dno,No_of_employees,Average_sal) (Dno COUNT Ssn,AVERAGE Salary)(Employ Renaming relation and attributes Group by Dno SELECT Dno, COUNT(SSN) AS No_of_employees, AVG(Salary) AS Average_sal FROM EMPLOYEE GROUP BY Dno
06-48	Aggregate & Grouping If no grouping attributes are specified, then the functions are applied to all tuples in the relation. Example: Retrieve the number of employees and their average salary. R(No_of_employees,Average_sal)(COUNT Ssn,AVERAGE Salary(Employee)) R
07-16	Recursive Closure Applied to a recursive relationship between tuples of the same type. Example: Retrieve all supervisees (at all levels) of an employee whose name is ‘James Borg’. We utilize a looping mechanism (Level 1) Retrieve all direct supervisees of an employee whose name is ‘James Borg’. (Level 2) Retrieve all supervisees of some employee who is directly supervised by ‘James Borg’. …. (Level n) …
08-04	Recursive Closure Example (cont’d): (Level 1) Retrieve all direct supervisees of an employee whose name is ‘James Borg’. BORG_SSN  Ssn(Fname=‘James’ AND Lname=‘Borg’(EMPLOYEE)) SUPERVISION(Ssn1, Ssn2) Ssn,Super_ssn(EMPLOYEE) RESULT1(Ssn) Ssn1(SUPERVISION Ssn2=SsnBORG_SSN)
09-47	Recursive Closure (Level 2) Retrieve all supervisees of some employee who is directly supervised by ‘James Borg’. RESULT2(Ssn) Ssn1(SUPERVISION Ssn2=SsnRESULT1) To get both set of employees supervised at level 1 and 2 by James Borg: RESULT RESULT2 RESULT1
10-56	Outer JOIN Notation: R1 R2 (left) or R1 R2 (right) or R1 R2 (full) Example: Left Outer JOIN TEMP (EMPLOYEE Ssn=Mgr_ssnDEPARTMENT) RESULT Fname, Minit, Lname, Dname(TEMP)
12-21	Outer UNION Take the union of tuples from two relations if the relations are not union compatible. Takes UNION of tuples in two relations R(X,Y) and S(X,Z) that are partially compatible, meaning that only some of their attributes, say X, are union compatible. The result relation T(X,Y,Z), the attributes that are union compatible are represented only once in the result, and those which are not union compatible from either relation are also kept in the result.
13-14	Outer UNION Example: Student(Name, Ssn, Department, Advisor) Instructor(Name, Ssn, Department, Rank) The resulting relation from applying Outer Union: STUDENT_OR_INSTRUCTOR(Name, Ssn, Department, Advisor, Rank) Appear only once NULL for tuples from Student relation NULL for tuples from Instructor relation
14-06	Exercise 1. For each department, retrieve the department name and the average salary of all employees working in that department. 2. Retrieve the average salary of all female employees. 3. Show the result of following operation: a. T1 T1.P = T2.A T2 b. T1 T1.Q = T2.B T2 c. T1 T1.P = T2.A T2 d. T1 T1.Q = T2.B T2 e. T1 T2 f. T1 (T1.P = T2.A AND T1.R = T2.C) T2
14-18	Exercise 4. For each project, list the project name and the total hours per week (by all employees) spent on that project. 5. List the name of the employees and their total working hours of all the same projects also done by the James Borg.
